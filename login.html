<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!--BS 5-->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
	<!--jQuery-->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<!--BS js-->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
		crossorigin="anonymous"></script>
	<script src="script.js"></script>
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.8.0/js/bootstrap-datepicker.min.js"></script>

	<link href="https://fonts.cdnfonts.com/css/montserrat" rel="stylesheet">
	<script src="https://kit.fontawesome.com/9dd1cea6a6.js" crossorigin="anonymous"></script>
	<title>Log In</title>
	<style>
		* {
			box-sizing: border-box;
			font-family: 'Montserrat';
			padding: 0;
			margin: 0;
			position: relative;
		}

		body {
			background-image: url("../img/bglogin.png");
			background-repeat: no-repeat;
			image-rendering: optimizeQuality;

		}
	</style>
	<script>
		$(function () {
			$('form[id!="login"][id!="upload"]').on('submit', function (e) {
				var validated = 1;
				var formData = [];
				//manual form data get and build but the upside is its ajax and data will be easier to insert in the table
				if (typeof ($(this).data('validation')) != "undefined") {
					//this could impact the response time but honestly idgaf
					$id = $($(this).parent().find('input[name^="id"]'));
					$yearLevel = $($(this).parent().find('select[name^="yearLevel"]'));
					$status = $($(this).parent().find('input[name^="status"]'));
					$fullName = $($(this).parent().find('input[name="fullName"]'));
					$email = $($(this).parent().find('input[name^="email"]'));
					$tel = $($(this).parent().find('input[name^="tel"]'));

					switch ($(this).data('validation')) {
						/*     
						student and faculty id should look like this:
						student: XX - XXXXXX
						faculty: FX - XXXXXX
						*/
						case 'student':
							if (!(/^[0-9]{1,2}-[0-9]{6,6}$/.test($id.val()))) {
								validated = 0;
								$id.siblings('p').text('Invalid').fadeOut(5000);
							}
							break;
						case 'faculty':
							if (!(/^F[0-9]{1,1}-[0-9]{6,6}$/.test($id.val()))) {
								validated = 0;
								$id.siblings('p').text('Invalid').fadeOut(5000);
							}
							break;
					}
					switch ($(this).data('type')) {
						case 'submit':
							formData.push({ name: 'action', value: 'submit' });
							formData.push({ name: 'id', value: $id.val() });
							formData.push({ name: 'password', value: Math.random().toString(36).substring(2, 10) })
							break;
					}
					formData.push({ name: 'table', value: $(this).data('validation') });
					//name check
					if ($fullName.length) {

					}
					else {

						var name = $($(this).parent().find('input[type="text"][name*="name"]')).map(function (index) {
							if (/[a-zA-Z ]$/.test($(this).val().toString())) {
								return $(this).val();
							}
							else {
								validated = 0;
								$(this).siblings('p').text('Invalid').fadeOut(5000);
							}
						}).get().join(':');
						formData.push({ name: 'name', value: name });
					}

					if ($(this).parent().find('input[type="text"][name*="doctor"]').length) {
						//doctor name check
						$($(this).parent().find('input[type="text"][name*="doctor"]')).map(function () {
							if (/^$|[a-zA-Z ]$/.test($(this).val().toString())) {
								status;
								return $(this).val();
							}
							else {
								validated = 0;
								$(this).siblings('p').text('Invalid').fadeOut(5000);
							}
						});
					}

					//status and Year Level check of student
					if ($(this).data('validation') == 'student') {
						if ($yearLevel.length) {
							formData.push({ name: 'yearLevel', value: $yearLevel.val() });
						}
						formData.push({ name: 'status', value: 'Enrolled' });
						if ($status.length) {
							formData.push({ name: 'status', value: $status.val() });
						}
					}

					//email
					formData.push({ name: 'email', value: '' });
					if ($email.length) {
						formData.pop();
						formData.push({ name: 'email', value: $email.val() });
					}
					//telephone
					formData.push({ name: 'tel', value: '' });
					if ($tel.length) {
						//tel validation
						if (!(/^09[0-9]{9,9}$/.test($tel.val()))) {
							validated = 0;
							$tel.siblings('p').text('invalid').fadeOut(5000);
						}
						formData.pop();
						formData.push({ name: 'tel', value: $tel.val() });
					}

					formData.push({ name: 'gender', value: $(this).parent().find('select[name^="gender"]').val() });
					formData.push({ name: 'birthday', value: $(this).parent().find('input[type="date"][name^="birthday"]').val() });
					formData.push({ name: 'address', value: $(this).parent().find('input[name^="address"]').val() });

					var key = ['firstdose', 'firstdoctor', 'seconddose', 'seconddoctor', 'vacbrand', 'booster', 'boosterdoctor', 'boosterbrand'];
					var selector = ['input[type="date"][name^="firstdose"]', 'input[type="text"][name^="firstdoctor"]', 'input[type="date"][name^="seconddose"]', 'input[type="text"][name^="seconddoctor"]', 'select[name^="vacbrand"]', 'input[type="date"][name^="booster"]', 'input[type="text"][name^="boosterdoctor"]', 'select[name^="boosterbrand"]']
					for (i = 0; i < 8; i++) {
						$find = $(this).parent().find(selector[i]);
						formData.push({ name: key[i], value: '' });
						if ($find.length) {
							if ($find.val()) {
								formData.pop();
								formData.push({ name: key[i], value: $find.val() });
							}
						}
					}

					console.log(formData);
					if (validated == 1) {
						$.post('conn.php', formData).done(function (response) {
							$('feedbackMessage').text('Inserted Successfully');
							$('#feedbackModal').modal('show');
						}).fail(function (response) {
							$('feedbackMessage').text('Unsuccessfully Insert in the Database');
							$('#feedbackModal').modal('show');

						});
					}
					e.preventDefault();
				}
			})
		});
	</script>
</head>

<body>
	<main>
		<div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<div id="feedbackMessage"></div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
						<button type="button" class="btn btn-primary">Save changes</button>
					</div>
				</div>
			</div>
		</div>
		<!--background image-->
		<div>
			<!--for logo-->
			<div class="container-fluid" id="loginPage">
				<div class="row">
					<div class="d-flex col-6 justify-content-center align-items-center " style="height:100vh;">
						<img src="img/loginlogo.png" class="img-fluid" alt="" style="image-rendering:optimizeQuality;">
					</div>
					<!--log in-->
					<div class="col-6 ">
						<div>
							<div class="container">
								<div class="d-inline container-fluid justify-content-center align-items-center "
									style="background-color:rgb(255, 255, 255); height:100vh;">
									<p class=" mb-5 mt-3 ms-4 pt-3" style="font-weight:900; font-size:60px;">Welcome</p>
									<div class="d-flex justify-content-center">
										<div id="card" class="card shadow-lg p-3 mb-5 bg-body rounded-5" style="width: 624px; height: 697px;">
											<form method="POST" id="login">
												<div class="card-body w-75 mx-auto">
													<p class="fs-1 fw-bold mt-3">Login</p>
													<div name="loginFeedback"></div>
													<div class="mb-3 my-3 py-3" style="width:450px;height:44px;">
														<label class="fw-semibold" style="font-size:28px" for="idNo">ID</label>
														<input type="text" class="form-control text-center" name="id[0]"
															required>
													</div>
													<div class="mb-3 my-5 py-5" style="width:450px;height:44px;">
														<label class="fw-semibold" style="font-size:28px" for="pwd">Password</label>
														<input type="password" name="password[0]"
															class="form-control text-center" required>
													</div>
													<p class="text-end">
														<a href="#" type="button" class="btn btn-link pt-3 mt-3" style="color:#ED7E00;">Forgot password?</a>
													</p>
													<div class=" gap-2 mx-auto text-center">
														<button type="submit" class="btn"
															style="margin-top:5%; border-radius:30px; background-color:rgb(16, 45, 65);color:white; font-size:24px; width:60%; height: 52px">Log
															In</button>
													</div>
												</div>
											</form>
											<div class="d-flex justify-content-center  p-1" style="margin-top:15%;">
												<label for="signUp" class="mt-2 opacity-50">Don`t have an account?</label>
													<button type="button" id="signUp" class="btn btn-link"
														data-bs-toggle="modal" data-bs-target="#signup"
														style="color:black; font-weight:bold;">
														Sign Up
													</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!--modal for signup-->
					<div class="modal fade" id="signup" tabindex="-1" aria-labelledby="signup" aria-hidden="true">
						<div class="modal-dialog modal-dialog-centered">
							<div class="modal-content">
								<div class="d-flex justify-content-end">
									<p class="fw-bold fs-1 me-5 mt-3" id="signup">Sign Up As?</p>
									<button type="button" class="btn-close ms-5 mt-2 me-2" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<div class="modal-body">
									<div class="d-grid gap-2 row mb-3">
										<div class="d-flex justify-content-center my-2">
											<button class="btn rounded-pill w-50 mh-100	fs-4"
												style="background-color:rgb(16, 45, 65); color:white"
												data-bs-dismiss="modal" id="signUpStudent" data-show="#student"
												data-hide="#loginPage" data-hide="#faculty">Student</button>
										</div>
										<div class="d-flex justify-content-center my-2">
											<button class="btn rounded-pill w-50 mh-100 fs-4"
												style="background-color:rgb(237, 126, 0); color:white"
												data-bs-dismiss="modal" id="signUpFaculty" data-show="#faculty"
												data-hide="#loginPage" data-hide="#student">Faculty</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!--student signup-->
			<div id="student" style="display: none;">
				<!--background image-->
				<div>
					<!--for logo-->
					<div class="container-fluid">
						<div class="row">
							<div class="d-flex col-6 justify-content-center align-items-center " style="height:100vh;">
								<img src="img/loginlogo.png" class="img-fluid" alt="">
							</div>
							<!--student sign up-->
							<div class="col-6 ">
								<div>
									<div class="container">
										<div class="container-fluid justify-content-center align-items-center "
											style="background-color:rgb(255, 255, 255); height:100vh;">
											<button class="btn btn-link fs-4 fw-bold mb-2 mt-5 ms-2 pt-5"
												style="color:black;" name="back[0]" data-show="#loginPage"
												data-hide="#student"><i class="fa-solid fa-angle-left"></i>Back</button>
											<div class="d-flex ms-5 ps-2">
												<div class=" mb-5">
													<form data-validation="student" data-type="submit">
														<p class="fs-1" style="font-weight:900;">Sign-Up</p>
														<p class="fs-5 fw-semibold">Create your <span
																class="text-warning">Student</span><br>account </p>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<label class="fw-semibold">First
																	Name</label>
																<input type="text" class="form-control" name="fname[]"
																	required>
																<p class="fw-bolder text-center text-danger"></p>
															</div>
															<div class="col-6">
																<label class="fw-semibold">Email
																	Address</label>
																<input type="text" class="form-control" name="email"
																	required>
																<div></div>
															</div>
														</div>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<label class="fw-semibold">Middle
																	Initial</label>
																<input type="text" class="form-control" name="mname[]"
																	required>
																<p class="fw-bolder text-center text-danger"></p>
															</div>
															<div class="col-6">
																<label class="fw-semibold">Birthday</label>
																<input type="date" class="form-control" name="birthday"
																	required>
																<div></div>
															</div>
														</div>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<label class="fw-semibold">Surname</label>
																<input type="text" class="form-control" name="lname[]"
																	required>
																<p class="fw-bolder text-center text-danger"></p>
															</div>
															<div class="col-6">
																<span class="fs-5 fw-semibold">Address</span>
																<input type="text" name="address" class="form-control"
																	required>
															</div>
														</div>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<span class="fs-5 fw-semibold">Gender</span>
																<select class="form-select text-center" name="gender"
																	required>
																	<option value="" hidden></option>
																	<option value="Male">Male</option>
																	<option value="Female">Female</option>
																</select>
															</div>
															<div class="col-6">
																<label class="fw-semibold">Year
																	Level</label>
																<select class="form-select" name="yearLevel" required>
																	<option value="" hidden></option>
																	<option value="Grade 7">Grade 7</option>
																	<option value="Grade 8">Grade 8</option>
																	<option value="Grade 9">Grade 9</option>
																	<option value="Grade 10">Grade 10</option>
																	<option value="Grade 11">Grade 11</option>
																	<option value="Grade 12">Grade 12</option>
																</select>
																<div></div>
															</div>
														</div>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<label class="fw-semibold">Student ID
																	Number</label>
																<input type="text" class="form-control" name="id"
																	required>
																<p class="fw-bolder text-center text-danger"></p>
															</div>
														</div>
														<div class="gap-2 mx-auto text-center">
															<div class=" gap-2 mx-auto text-center">
																<button type="submit" class="btn"
																	style="width:50%; border-radius:30px; background-color:rgb(237, 126, 0);color:white; font-size:24px; width:60%; height: 52px">Sign-up</button>
															</div>
														</div>
													</form>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!--Faculty sign up-->
			<div id="faculty" style="display: none;">
				<div>
					<!--for logo-->
					<div class="container-fluid">
						<div class="row">
							<div class="d-flex col-6 justify-content-center align-items-center " style="height:100vh;">
								<img src="img/loginlogo.png" class="img-fluid" alt="">
							</div>
							<!--Faculty sign up-->
							<div class="col-6 ">
								<div>
									<div class="container">
										<div class="container-fluid justify-content-center align-items-center "
											style="background-color:rgb(255, 255, 255); height:100vh;">
											<button class="btn btn-link fs-4 fw-bold mb-2 mt-5 ms-2 pt-5"
												style="color:black;" name="back[1]" data-show="#loginPage"
												data-hide="#faculty"><i class="fa-solid fa-angle-left"></i>Back</button>
											<div class="d-flex ms-5 ps-2">
												<div class=" mb-5">
													<form data-validation="faculty" data-action="submit">
														<p class="fs-1" style="font-weight:900;">Sign-Up</p>
														<p class="fs-5 fw-semibold">Create your <span
																class="text-warning">Faculty</span><br>account </p>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<label class="fw-semibold">First
																	Name</label>
																<input type="text" class="form-control" name="fname[]"
																	required>
																<p class="fw-bolder text-center text-danger"</p>
															</div>
															<div class="col-6">
																<label class="fw-semibold">Email
																	Address</label>
																<input type="text" class="form-control" name="email"
																	required>
																<div></div>
															</div>
														</div>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<label class="fw-semibold">Middle
																	Initial</label>
																<input type="text" class="form-control" name="mname[]"
																	required>
																<p class="fw-bolder text-center text-danger"></p>
															</div>
															<div class="col-6">
																<span class="fs-5 fw-semibold">Address</span>
																<input type="text" name="address" class="form-control"
																	required>
															</div>
														</div>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<label class="fw-semibold">Surname</label>
																<input type="text" class="form-control" name="lname[]"
																	required>
																<p class="fw-bolder text-center text-danger"></p>
															</div>
															<div class="col-6">
																<label class="fw-semibold">Birthday</label>
																<input type="date" class="form-control" name="birthday"
																	required>
																<div></div>
															</div>
														</div>
														<div class="row mb-3 my-4">
															<div class="col-6">
																<label class="fw-semibold">Faculty ID
																	Number</label>
																<input type="text" class="form-control" name="id"
																	required>
																<p class="fw-bolder text-center text-danger"></p>
															</div>
															<div class="col-6">
																<span class="fs-5 fw-semibold">Gender</span>
																<select class="form-select text-center" name="gender"
																	required>
																	<option value="" hidden></option>
																	<option value="Male">Male</option>
																	<option value="Female">Female</option>
																</select>
															</div>
														</div>
														<div class="gap-2 mx-auto text-center">
															<div class=" gap-2 mx-auto text-center">
																<button type="submit" class="btn"
																	style="width:50%; border-radius:30px; background-color:rgb(237, 126, 0);color:white;font-size:24px; width:60%; height: 52px">Sign-up</button>
															</div>
														</div>
													</form>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
</body>

</html>